# Web RogueLike Demo - Specification

## Overview
A minimalist web-based roguelike demo implemented with Node.js, Express, and vanilla JavaScript. Generates a random dungeon map on each page load and allows basic player movement.

## Requirements
- Node.js and npm
- Dependencies installed via `npm install`

## Setup & Run
1. Install dependencies:
   ```bash
   npm install
   ```
2. Generate data definitions:
   ```bash
   npm run extract-data
   ```
3. Start the server:
   ```bash
   npm start
   ```
3. Open your browser at `http://localhost:3000`

## Architecture

### Server (`server.js`)
- Serves static files from the `public` directory.
- Listens on port `3000` (or the port specified by the `PORT` environment variable).

### Client (`public/app.js`)
- **Map generation**:
  - Dimensions: `width = 80`, `height = 24`.
  - Dungeon layout generated by original Rogue algorithm:
    - Nine rooms in a 3Ã—3 grid, rectangular or maze-style.
    - Corridors connecting rooms with doors (`+`) and passages (`#`).
    - Floors as `.` and walls as `|` (vertical) or `-` (horizontal).
- **Player**:
  - Represented by `@`.
  - Initial position: `(1,1)`.
  - Health points (HP): starts at `10`.
**Rendering**:
  - The `#map` element displays the map, monsters, items, and player using preformatted text.
  - The `#status` element displays the player's HP, strength, and level.
**Controls**:
  - Arrow keys (`ArrowUp`, `ArrowDown`, `ArrowLeft`, `ArrowRight`) to move.
  - Movement is blocked by room walls (`|`, `-`) and off-map spaces; allowed on floors (`.`), passages (`#`), and doors (`+`).
  - Move into a monster to attack, or into an item to pick it up.
  - Press `i` to show inventory.
  - Press `u` to use items (read scrolls, zap sticks, wear rings, wield weapons, etc.).
  - Map rerenders after each move and monster turns.

### Styles (`public/index.html`)
- Font: monospace.
- Background color: `#111`; text color: `#0f0`.
- Map styling: `line-height: 1.2`, `white-space: pre`, `font-size: 16px`.
- Layout: map and status are centered horizontally and vertically in the viewport (flexbox).
- Status styling: `margin-top: 8px`.

## Limitations & TODO
- Data definitions extracted under `public/data`, ready for integration.
- Monsters placed in dungeon rooms; basic combat and monster AI implemented.
- Items can be picked up and added to inventory; basic item usage implemented.
- Weapons, armor, and rings can be equipped (no stat effects beyond equipping).
- Potions have full HP and strength effects implemented (healing, extra healing, poison, gain/restore strength, raise level).
- Scroll and ring effects are now implemented (mapping, confusion, teleportation, enchant, add strength, protection, see invisible, etc.). Stick (wand) effects not implemented.
- Potion of raise level grants level increase; XP-based leveling not implemented.
- Map resets only on page reload.

## Development Plan & Progress

The following development tasks are planned to incrementally implement missing features. The status of each task is tracked below.

| Task No. | Feature                         | Description                                                                                                                | Status      |
|:--------:|---------------------------------|----------------------------------------------------------------------------------------------------------------------------|-------------|
| 1        | Potions (remaining effects)     | Add confusion, hallucination, see invisible, monster detection, magic detection, haste self, blindness, levitation effects | Done         |
| 2        | Sticks (wand effects)           | Implement all 14 wand effects as defined in public/data/sticks.json                                                       | Done        |
| 3        | Experience & Leveling           | Grant experience on monster kill and implement level-up mechanics                                                          | Done        |
| 4        | Equipment Stats                 | Reflect weapon, armor, and ring stats (damage bonuses, AC, etc.)                                                           | Pending     |
| 5        | Hit/Miss & Armor Class          | Add hit/miss calculations and armor class damage reduction                                                                 | Pending     |