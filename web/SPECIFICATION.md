# Web RogueLike Demo - Specification

## Overview
A minimalist web-based roguelike demo implemented with Node.js, Express, and vanilla JavaScript. Generates a random dungeon map on each page load and allows basic player movement.

## Requirements
- Node.js and npm
- Dependencies installed via `npm install`

## Setup & Run
1. Install dependencies:
   ```bash
   npm install
   ```
2. Generate data definitions:
   ```bash
   npm run extract-data
   ```
3. Start the server:
   ```bash
   npm start
   ```
3. Open your browser at `http://localhost:3000`

## Architecture

### Server (`server.js`)
- Serves static files from the `public` directory.
- Listens on port `3000` (or the port specified by the `PORT` environment variable).

### Client (`public/app.js`)
- **Map generation**:
  - Dimensions: `width = 80`, `height = 24`.
  - Dungeon layout generated by original Rogue algorithm:
    - Nine rooms in a 3Ã—3 grid, rectangular or maze-style.
    - Corridors connecting rooms with doors (`+`) and passages (`#`).
    - Connectivity: all rooms and corridors are guaranteed to be connected; no isolated sections.
    - Floors as `.` and walls as `|` (vertical) or `-` (horizontal).
- **Player**:
  - Represented by `@`.
  - Initial position: `(1,1)`.
  - Health points (HP): starts at `10`.
**Rendering**:
  - The `#map` element displays the map, monsters, items, and player using preformatted text.
  - The `#status` element displays the player's HP, strength, and level.
  - When the player's HP reaches 0 or below, a GAME OVER screen is displayed; press any key to restart.
**Controls**:
  - Arrow keys (`ArrowUp`, `ArrowDown`, `ArrowLeft`, `ArrowRight`) to move.
  - Movement is blocked by room walls (`|`, `-`) and off-map spaces; allowed on floors (`.`), passages (`#`), and doors (`+`).
  - Move into a monster to attack, or into an item to pick it up.
  - Press `i` to show inventory.
  - Press `u` to use items (read scrolls, zap sticks, wear rings, wield weapons, etc.).
  - Map rerenders after each move and monster turns.

### Styles (`public/index.html`)
- Font: monospace.
- Background color: `#111`; text color: `#0f0`.
- Map styling: `line-height: 1.2`, `white-space: pre`, `font-size: 16px`.
- Layout: map and status are centered horizontally and vertically in the viewport (flexbox).
- Status styling: `margin-top: 8px`.

## Limitations & TODO
- Data definitions extracted under `public/data`, ready for integration.
- Monsters placed in dungeon rooms; basic combat and monster AI implemented.
- Items can be picked up and added to inventory; basic item usage implemented.
- Weapons, armor, and rings can be equipped and their stats (damage bonuses, armor class, and ring effects) are now active.
- Potions have full HP and strength effects implemented (healing, extra healing, poison, gain/restore strength, raise level).
- Scroll, ring, and stick (wand) effects are now implemented (mapping, confusion, teleportation, enchant, add strength, protection, see invisible, etc.).
- Dungeon levels with stairs implemented; ascend '<' and descend '>' to move between floors.

## Missing Features

Below are key features and mechanics defined in the original Rogue (v5.4.4-ant-r1.1.2) that are not yet implemented in this demo:

- **Gold & Score**: monster gold drops, picking up gold, score tracking.
- **Food & Hunger**: consumable food items, hunger countdown, starvation.
- **Ranged Combat**: bows & arrows, ranged attack mechanics.
- **Secret Doors & Traps**: hidden doors, trap generation, trap detection & activation.
- **Doors & Locks**: locked doors, key usage, door opening/closing.
- **Monster AI & Behaviors**: flying, multiple attacks, regeneration, erratic movement, etc.
- **Functional Wand Effects**: lightning, fire, cold, polymorph, magic missile, cancellation, etc.
- **Curses & Blessings**: cursed/blessed items, remove curse effect.
- **Polymorph**: polymorphing monsters or player.
- **Teleportation Ring**: random teleport effect of ring of teleportation.
- **Identification Mechanics**: reveal item names, handle guessing and known states.
- **Score Saving & Leaderboard**: saving game state and high score display.

## Development Plan & Progress

The following development tasks are planned to incrementally implement missing features. The status of each task is tracked below.

| Task No. | Feature                         | Description                                                                                                                | Status      |
|:--------:|---------------------------------|----------------------------------------------------------------------------------------------------------------------------|-------------|
| 1        | Potions (remaining effects)     | Add confusion, hallucination, see invisible, monster detection, magic detection, haste self, blindness, levitation effects | Done        |
| 2        | Sticks (wand effects)           | Implement all 14 wand effects as defined in public/data/sticks.json                                                       | Done        |
| 3        | Experience & Leveling           | Grant experience on monster kill and implement level-up mechanics                                                          | Done        |
| 4        | Equipment Stats                 | Reflect weapon, armor, and ring stats (damage bonuses, AC, etc.)                                                           | Done        |
| 5        | Hit/Miss & Armor Class          | Add hit/miss calculations and armor class damage reduction                                                                 | Done        |
| 6        | Dungeon Levels & Stairs         | Place up/down staircases and allow ascending/descending between dungeon levels                                            | Done        |
| 7        | Gold & Hunger                   | Implement gold drops and food/hunger mechanics                                                                             | Pending     |
| 8        | Ranged Combat & Arrows          | Add bows & arrows and ranged attack mechanics                                                                              | Pending     |
| 9        | Secret Doors & Traps            | Generate traps and secret doors; implement search and trap detection                                                       | Pending     |
| 10       | Full Wand Effects               | Implement functional effects for all wands (lightning, polymorph, etc.)                                                    | Pending     |
| 11       | Monster AI & Flags              | Support monster flags (flying, regeneration, multi-attack) and advanced AI behaviors                                      | Pending     |
| 12       | Curses & Identification         | Add cursed/blessed items, remove curse effect, and proper identification (guess/know)                                      | Pending     |
| 13       | Score & Save Game               | Track and display scores; implement game saving/loading and leaderboard                                                    | Pending     |